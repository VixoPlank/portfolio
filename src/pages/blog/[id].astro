---
import { getCollection, render } from 'astro:content'
import BlogLayout from '../../layouts/BlogLayout.astro'
import { formatDate } from '../../utils/formatDate'

export async function getStaticPaths() {
	const posts = await getCollection('posts')
	return posts.map((post) => ({
		params: { id: post.slug },
		props: { post }
	}))
}

const { post } = Astro.props
const { data, slug } = post
const { title, description, image, publishDate, tags } = data

const { Content } = await render(post)
---

<BlogLayout title={`${title} | Vicente VÃ¡squez`} {description}>
	<article class='mx-auto w-full py-12 lg:w-[745px]'>
		<header class='mb-10'>
			<h1
				class='mb-4 bg-gradient-to-r from-[#004aad] to-[#38b6ff] bg-clip-text text-4xl font-bold text-transparent md:text-5xl'
			>
				{title}
			</h1>

			<div class='mb-6 flex items-center justify-between text-gray-400'>
				<div class='flex gap-2'>
					{
						tags.map((tag) => (
							<span class='rounded-lg bg-[#292C35] px-2 py-1 text-sm font-semibold text-[#4B6BFB]'>
								#{tag}
							</span>
						))
					}
				</div>
				<time datetime={publishDate.toISOString()} class='text-sm'>
					{formatDate(publishDate)}
				</time>
			</div>
		</header>

		<figure class='mb-10 overflow-hidden rounded-xl shadow-lg'>
			<img
				transition:name={`img-${slug}`}
				src={image}
				alt={title}
				class='h-auto w-full object-cover'
				loading='lazy'
			/>
		</figure>

		<main class='prose prose-invert prose-lg max-w-none'>
			<Content />
		</main>

		<footer class='mt-12 border-t border-gray-800 pt-6'>
			<a href='/blog' class='inline-flex items-center gap-2 text-blue-500 hover:underline'>
				<svg
					xmlns='http://www.w3.org/2000/svg'
					class='h-5 w-5'
					viewBox='0 0 20 20'
					fill='currentColor'
				>
					<path
						fill-rule='evenodd'
						d='M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z'
						clip-rule='evenodd'></path>
				</svg>
				Volver al Blog
			</a>
		</footer>
	</article>
</BlogLayout>
